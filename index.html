<!doctype html>
<!-- The Time Machine GitHub pages theme was designed and developed by Jon Rohan, on Feb 7, 2012. -->
<!-- Follow him for fun. http://twitter.com/jonrohan. Tail his code on https://github.com/jonrohan -->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <link rel="stylesheet" href="stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" href="stylesheets/github-dark.css">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/script.js"></script>

  <title>Sam2</title>
  <meta name="description" content=" SAM2 est un mini-projet de domotique, il pilote les objets connectés de mon logement.">

  <meta name="viewport" content="width=device-width,initial-scale=1">

</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title">Sam2</h1>
    </header>
    <div id="container">
      <p class="tagline"> SAM2 est un mini-projet de domotique, il pilote les objets connectés de mon logement.</p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/chuchunain/sam2/tarball/master" class="download-button tar"><span>Download</span></a>
          <a href="https://github.com/chuchunain/sam2/zipball/master" class="download-button zip"><span>Download</span></a>
          <a href="https://github.com/chuchunain/sam2" class="code">View Sam2 on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
          <h1>
<a id="sam" class="anchor" href="#sam" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>sam</h1>

<p>Par Matthieu ONFRAY (<a href="http://www.onfray.info">http://www.onfray.info</a>)
Licence : CC by sa</p>

<p>SAM pour Système Autonome de Maison est un projet d'amusement open-source combinant un peu de code, un peu d'électronique afin d'automatiser des équipements privés : lampes, volets, etc. branchés sur des modules à ondes (type Chacon DIO). Ce mini-projet de domotique use du PHP, du Javascript, un peu de shell...</p>

<p>1) Il vous faut un :</p>

<ul>
<li>ordinateur sous linux (PC/Raspberry pi/autre)</li>
<li>serveur Web (Apache/Nginx/autre)</li>
<li>PHP 5 et supérieur</li>
<li>émetteur radio 433Mhz connecté sur l'ordinateur</li>
<li>modules radio récepteurs DIO chacon pour piloter vos équipements (volets, lampes, etc.)</li>
<li>SAM installé et configuré dans un répertoire de votre serveur web (/var/www/sam idéalement sinon il faut changer le chemin dans constantes.php et mamaison.sh)</li>
</ul>

<p>2) Installation
Déposer le dossier sam dans votre /var/www
Donner les droits d'éxécution sur le binaire radioEmission (sudo chown root:www-data /var/www/sam/radioEmission
puis un sudo chmod 4777 radioEmission) sinon l'interface web ne fonctionnera pas !
Donner les droits d'éxécution sur ma_maison.sh à votre utilisateur de seveur web (www-data souvent)
Ajouter dans la crontab le lancement chaque nuit à 1h00 du script cron.php pour un utilisateur du système (www-data)
Exemple de ligne : 
0 1 * * * php /var/www/sam/cron.php #exécution nocturne de sam :)</p>

<p>3) Utilisation</p>

<p>Connexion : </p>

<p>L'interface web se trouvera sur http://ip-de-votre-serveur/sam (ou autre selon la conf du serveur web).
Vous vous connectez avec votre utilisateur (à régler dans id.php avec un éditeur de texte) ou sans vous connecter (mettre sécurisation à false dans constant.php avec votre éditeur de texte). En cas de connexion sécurisée, un cookie est déposé pour un an sur votre client pour éviter de vous reloguer à chaque fois.
En cas de sécurisation votre serveur doit permettre les sessions pour le système captcha.</p>

<p>Page d'accueil :</p>

<p>La première page permet de :</p>

<ul>
<li>allumer/éteindre les lampes définies </li>
<li>fermer/ouvrir les volets définis</li>
<li>accéder à la configuration</li>
</ul>

<p>Page configuration :
Définissez autant de règles que vous voulez ! Entrez un nom de règle, puis les codes des modules (volets, lampes, etc), les périodes d'activation de la programmation (semaine, week-end, ou encore semaine et week-end). </p>

<p>Un fichier de votre conf est créé par le programme (droits d'écriture nécessaire dans le répertoire sam).
Le lever et le coucher du soleil sont calculés selon la ville choisie dans la liste déroulante. Sélectionnez la plus proche de vous, j'ai retenu les nouvelles capitales de région (Bordeaux, Rouen, Lyon, etc). Par défaut c'est Rouen.
Si vous déménagez loin, il est logique de retourner choisir la nouvellle ville la plus proche.</p>

<p>4) Ressources et inspirations
<a href="http://blog.idleman.fr/raspberry-pi-12-allumer-des-prises-distance/">http://blog.idleman.fr/raspberry-pi-12-allumer-des-prises-distance/</a>
<a href="https://www.guillaume-leduc.fr/gestion-caches-nginx-php-fpm.html">https://www.guillaume-leduc.fr/gestion-caches-nginx-php-fpm.html</a>
<a href="http://legissa.ovh/internet-se-proteger-des-pirates-et-hackers.html">http://legissa.ovh/internet-se-proteger-des-pirates-et-hackers.html</a></p>
        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/chuchunain" class="avatar"><img src="https://avatars2.githubusercontent.com/u/18144846?v=3&amp;s=60" width="48" height="48"></a> <a href="https://github.com/chuchunain">chuchunain</a> maintains <a href="https://github.com/chuchunain/sam2">Sam2</a></p>


      </div>
      <div class="creds">
        <small>This page generated using <a href="https://pages.github.com/">GitHub Pages</a><br>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/chuchunain/sam2/tarball/master" class="tar">tar</a><a href="https://github.com/chuchunain/sam2/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>

  
</body>
</html>
